<!DOCTYPE html>
<html lang="en">

</html>

<head>
	<title>Babylon PathTracing Renderer</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1">

	<style>
		html,
		body {
			overflow: hidden;
			width: 100%;
			height: 100%;
			margin: 0;
			padding: 0;
		}

		#renderCanvas {
			width: 100%;
			height: 100%;
			touch-action: none;
		}
	</style>
	<script src="js/babylon.js"></script>

	<!-- this is the required demo/scene-specific setup .js file for each pathtraced scene -->
	<script src="js/Babylon_Path_Tracing.js"> </script>
 
</head>

<body>

	<canvas id="renderCanvas" touch-action="none"></canvas> <!-- touch-action="none" for best results from PEP -->

	<!-- use this uncompressed version of the library while debugging -->
	<!-- <script src="js/babylon.max.js"></script>  -->

	<!-- use this minified version of the library for deployment -->

	<script>
		var engine;


		const canvas = document.getElementById("renderCanvas");
		const urlParams = new URLSearchParams(window.location.search);
		const shouldRenderOffscreen = urlParams.get('renderOffscreen') == true;

		if (shouldRenderOffscreen) {
			console.log("rendering offscreen");
			var offscreen = canvas.transferControlToOffscreen();
			var worker = new Worker("./js/worker.js");
			worker.postMessage({ canvas: offscreen }, [offscreen]);

			window.addEventListener("resize", () => {
				worker.postMessage({ width: canvas.clientWidth, height: canvas.clientHeight });
			});
		}
		else {
			console.log("rendering normally");
			engine = new BABYLON.Engine(canvas, true);
			RealtimeRT.createScene(engine, canvas);
		}


	</script>

</body>

</html>